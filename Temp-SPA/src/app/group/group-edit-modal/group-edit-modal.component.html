<div class="modal-header-obsidian">
    <h4 class="modal-title-obsidian">{{title}}</h4>
    <button type="button" class="modal-close-obsidian" aria-label="Close" (click)="bsModalRef.hide()">
        <span class="modal-close-icon" aria-hidden="true">Ã—</span>
    </button>
</div>
<div class="modal-body-obsidian">
    <tabset>
        <tab heading="Profile">
            <form [formGroup]="editGroupForm" (ngSubmit)="update()">
                <tmp-card variant="filled" class="employee-profile-card">
                    <div class="employee-profile-header">
                        <tmp-avatar
                            [profilePictureUrl]="profilePictureUrl"
                            [displayName]="name.value ?? undefined"
                            [size]="'large'"
                            [shape]="'circle'">
                        </tmp-avatar>
                        <div class="employee-profile-info">
                            <p class="employee-name">{{ name.value }}</p>
                        </div>
                    </div>
                </tmp-card>

                <tmp-card variant="filled" class="form-card">
                    <h4 class="section-title">Group Details</h4>
                    <div class="modal-form-section modal-form-section-tight">
                        <tmp-input [formControl]="name" [label]="'Name'" [placeholder]="'Enter Group Name'"></tmp-input>
                    </div>
                </tmp-card>

                <div class="modal-actions">
                    <tmp-button type="submit" variant="success" [disabled]="!editGroupForm.valid">Save Group</tmp-button>
                </div>
            </form>
        </tab>

        <tab heading="Files">
            <div class="employee-files-grid">
                <tmp-card variant="filled" class="upload-card">
                    <h4 class="section-title">Upload Files</h4>
                    <div class="modal-form-section modal-form-section-tight">
                        <div class="modal-upload-section">
                            <tmp-file-upload
                                [label]="'Upload Photo'"
                                [fileType]="'Image'"
                                [maxSizeMB]="5"
                                [uploadedFiles]="groupFiles"
                                (fileUploaded)="onFileUploaded($event)"
                                (fileDeleted)="onFileDeleted($event)">
                            </tmp-file-upload>
                        </div>
                        <div class="modal-upload-section">
                            <tmp-file-upload
                                [label]="'Upload Documents'"
                                [fileType]="'Document'"
                                [maxSizeMB]="10"
                                [uploadedFiles]="groupFiles"
                                (fileUploaded)="onFileUploaded($event)"
                                (fileDeleted)="onFileDeleted($event)">
                            </tmp-file-upload>
                        </div>
                    </div>
                </tmp-card>

                <tmp-card variant="filled" class="files-table-card">
                    <h4 class="section-title">File Library</h4>
                    <tmp-table [hoverable]="true">
                        <thead>
                            <tr>
                                <th>File Name</th>
                                <th>Type</th>
                                <th class="text-center">Preview</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (groupFiles && groupFiles.length > 0) {
                                @for (file of groupFiles; track file.name) {
                                <tr>
                                    <td class="file-name" [attr.title]="file.name">{{file.name}}</td>
                                    <td>{{file.fileType}}</td>
                                    <td class="text-center">
                                        @if (file.fileType === 'Image') {
                                        <tmp-avatar
                                            [profilePictureUrl]="file.name"
                                            [displayName]="file.name"
                                            [size]="'small'"
                                            [shape]="'square'">
                                        </tmp-avatar>
                                        } @else {
                                        <fa-icon [icon]="fileIcon" [size]="'xl'"></fa-icon>
                                        }
                                    </td>
                                </tr>
                                }
                            } @else {
                            <tr>
                                <td colspan="3" class="empty-state">No files uploaded</td>
                            </tr>
                            }
                        </tbody>
                    </tmp-table>
                </tmp-card>
            </div>
        </tab>
    </tabset>
</div>
