<div class="employee-list-header">
  <div class="employee-list-title-section">
    <h1 class="employee-list-title">Employees</h1>
    <p class="employee-list-subtitle">Manage and view all employees in the system</p>
  </div>
</div>

<div class="employee-list-container">
  <!-- Filters Card -->
  <tmp-card variant="subtle" class="employee-list-filters-card">
    <div class="employee-list-filters-header">
      <h3 class="employee-list-filters-title">Filters</h3>
      <tmp-button variant="success" size="small" (clicked)="openCreateModal()" ariaLabel="Create employee">
        <fa-icon [icon]="plusIcon" [size]="'xl'"></fa-icon>
        <span style="margin-left: var(--spacing-xs);">Create</span>
      </tmp-button>
    </div>
    <form class="employee-list-filters-form" [formGroup]="filtersForm">
      <tmp-select [options]="rolesSelect" label="Role" formControlName="role" [isFilter]="true"></tmp-select>
      <tmp-input placeholder="First Name" label="First Name" formControlName="firstName" [isFilter]="true"></tmp-input>
      <tmp-input placeholder="Last Name" label="Last Name" formControlName="lastName" [isFilter]="true"></tmp-input>
    </form>
  </tmp-card>

  <!-- Data Table Card -->
  <tmp-card variant="filled" class="employee-list-table-card">
    <tmp-table
      [columns]="columns"
      [data]="employees"
      [striped]="true"
      [hoverable]="true"
      [loading]="isLoading"
      emptyMessage="No employees found">

      <!-- Custom row template for complex content -->
      <ng-template #rowTemplate let-employee>
        <tr>
          <td>{{ employee.firstName }}</td>
          <td>{{ employee.lastName }}</td>
          <td class="text-center">
            <tmp-badge
              variant="filled"
              [color]="employee.role === 'Admin' ? 'warning' :
                       employee.role === 'Moderator' ? 'success' :
                       employee.role === 'User' ? 'info' : 'neutral'">
              {{ employee.role }}
            </tmp-badge>
          </td>
          <td class="text-center">
            <div class="tmp-button-group">
              <!-- Edit button -->
              <tmp-button variant="primary" size="small" (clicked)="openEditModal(employee.id)" ariaLabel="Edit employee {{employee.firstName}} {{employee.lastName}}">
                <fa-icon [icon]="editIcon" [size]="'lg'"></fa-icon>
              </tmp-button>

              <!-- Assign role (only for None role) -->
              @if (employee.role === 'None') {
                <tmp-button variant="info" size="small" (clicked)="openAssignRoleModal(employee.id, employee.firstName, employee.lastName)" ariaLabel="Assign role to {{employee.firstName}} {{employee.lastName}}">
                  <fa-icon [icon]="assignRoleIcon" [size]="'lg'"></fa-icon>
                </tmp-button>
              }

              <!-- Status toggle and remove role (for assigned roles) -->
              @if (employee.role !== 'None') {
                <tmp-button
                  [variant]="employee.isAppUserActive ? 'success' : 'warning'"
                  size="small"
                  (clicked)="changeStatus(employee.id)"
                  ariaLabel="{{employee.isAppUserActive ? 'Deactivate' : 'Activate'}} {{employee.firstName}} {{employee.lastName}}">
                  <fa-icon [icon]="employee.isAppUserActive ? deactivateUserIcon : activateUserIcon" [size]="'lg'"></fa-icon>
                </tmp-button>
                <tmp-button variant="danger" size="small" (clicked)="removeRole(employee.id)" ariaLabel="Remove role from {{employee.firstName}} {{employee.lastName}}">
                  <fa-icon [icon]="removeRoleIcon" [size]="'lg'"></fa-icon>
                </tmp-button>
              }
            </div>
          </td>
        </tr>
      </ng-template>
    </tmp-table>
  </tmp-card>

  <!-- Pagination -->
  <div class="employee-list-pagination">
    <tmp-pagination
      [totalCount]="pagination.totalItems"
      [pageSize]="pagination.itemsPerPage"
      [pageNumber]="pagination.currentPage"
      (pageChanged)="pageChanged($event)">
    </tmp-pagination>
  </div>
</div>
