/**
 * OBSIDIAN NOIR - Input Component (Redesigned)
 * Optimized to prevent global style leaks and ensure clean single borders.
 */

/* ===================================
 * WRAPPER
 * =================================== */
.tmp-input-wrapper {
  display: flex;
  flex-direction: column;
  gap: 4px;
  width: 100%;
  position: relative;
}

/* ===================================
 * CONTAINER
 * The primary visual element. All borders and backgrounds are here.
 * =================================== */
.tmp-input-container {
  position: relative;
  display: block;
  background: #1f1f2e;
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--border-radius-medium);
  transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
  height: 60px; /* Fixed height instead of min-height */
  width: 100%;
  cursor: text;
  box-sizing: border-box;
  overflow: hidden;
}

/* Hover State */
.tmp-input-container:hover:not(.tmp-input-disabled):not(.tmp-input-error):not(.tmp-input-focused) {
  border-color: var(--color-border-strong);
  background-color: var(--color-surface-3);
}

/* Focus State - Single Clean Border with Glow */
.tmp-input-focused:not(.tmp-input-disabled):not(.tmp-input-error) {
  border: 1px solid var(--color-brand-primary) !important;
  box-shadow: 0 0 0 1px var(--color-brand-primary), var(--shadow-glow-teal-sm);
  background-color: var(--color-surface-1);
}

/* Success State */
.tmp-input-success:not(.tmp-input-error) {
  border-color: var(--color-success-primary);
}

.tmp-input-success.tmp-input-focused {
  border: 1px solid var(--color-success-primary) !important;
  box-shadow: 0 0 0 1px var(--color-success-primary), 0 0 15px rgba(16, 185, 129, 0.25);
}

/* Error State */
.tmp-input-error {
  border: 1px solid var(--color-error-primary) !important;
}

.tmp-input-error.tmp-input-focused {
  box-shadow: 0 0 0 1px var(--color-error-primary), 0 0 15px rgba(244, 63, 94, 0.25);
}

/* Disabled State */
.tmp-input-disabled {
  opacity: 0.5;
  background-color: var(--color-surface-3);
  cursor: not-allowed;
}

/* ===================================
 * INTERNAL INPUT FIELD
 * Stripped of all independent visual properties to prevent leaks.
 * =================================== */
.tmp-input-field {
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  padding: 28px 44px 8px 16px;
  display: block;
  color: var(--color-foreground-1);
  font-family: inherit;
  font-size: var(--font-size-300);
  line-height: normal;

  /* Critical: Remove all native styling */
  border: none !important;
  background: transparent !important;
  outline: none !important;
  box-shadow: none !important;
  border-radius: 0;
  margin: 0;
}

/* Suppress global focus ring and validation styles - these should be redundant now */
.tmp-input-field:focus,
.tmp-input-field:focus-visible,
.tmp-input-field.ng-valid,
.tmp-input-field.ng-invalid,
.tmp-input-field.is-valid,
.tmp-input-field:valid,
.tmp-input-field:invalid {
  outline: none !important;
  box-shadow: none !important;
  border: none !important;
  background-image: none !important;
  background-color: transparent !important;
}

/* Fix for Chrome Autofill - Override default light blue background */
.tmp-input-field:-webkit-autofill,
.tmp-input-field:-webkit-autofill:hover,
.tmp-input-field:-webkit-autofill:focus,
.tmp-input-field:-webkit-autofill:active {
  /* Override text color */
  -webkit-text-fill-color: var(--color-foreground-1) !important;

  /* Override background - use large inset shadow to cover entire input */
  -webkit-box-shadow: 0 0 0 1000px #1f1f2e inset !important;

  /* Force background color (belt and suspenders approach) */
  background-color: #1f1f2e !important;
  background-image: none !important;

  /* Remove any borders */
  border: none !important;
  outline: none !important;

  /* Keep caret visible */
  caret-color: var(--color-foreground-1) !important;

  /* Prevent transition that would revert styling */
  transition: background-color 5000s ease-in-out 0s !important;
}

/* Also target the autofill selected state */
.tmp-input-field:-webkit-autofill::selection,
.tmp-input-field:-webkit-autofill:hover::selection,
.tmp-input-field:-webkit-autofill:focus::selection {
  background-color: var(--color-brand-primary) !important;
  color: var(--color-foreground-on-brand) !important;
}

/* Fix for number input spinners being white boxes */
.tmp-input-field::-webkit-inner-spin-button,
.tmp-input-field::-webkit-outer-spin-button {
  filter: invert(1) hue-rotate(180deg);
  opacity: 0.6;
  cursor: pointer;
}

.tmp-input-field::-webkit-inner-spin-button:hover,
.tmp-input-field::-webkit-outer-spin-button:hover {
  opacity: 1;
}

/* ===================================
 * FLOATING LABEL
 * =================================== */
.tmp-input-label {
  position: absolute;
  left: 16px;
  top: 50%;
  transform: translateY(-50%);
  font-size: var(--font-size-300);
  color: var(--color-foreground-3);
  pointer-events: none;
  transition: all 200ms cubic-bezier(0.4, 0, 0.2, 1);
  transform-origin: left center;
  z-index: 2;
}

/* Floating state */
.tmp-input-filled .tmp-input-label,
.tmp-input-focused .tmp-input-label,
.tmp-input-field:not(:placeholder-shown) + .tmp-input-label {
  transform: translateY(-115%) scale(0.85); /* Improved headroom */
  color: var(--color-foreground-3);
  font-weight: var(--font-weight-semibold);
}

/* Focus color for label */
.tmp-input-focused .tmp-input-label {
  color: var(--color-brand-primary);
}

.tmp-input-error .tmp-input-label {
  color: var(--color-error-primary);
}

.tmp-input-success .tmp-input-label {
  color: var(--color-success-primary);
}

/* ===================================
 * ICONS & MESSAGES
 * =================================== */
.tmp-input-icon {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  z-index: 5;
  pointer-events: none;
}

.tmp-input-icon-success { color: var(--color-success-primary); }
.tmp-input-icon-error { color: var(--color-error-primary); }

.tmp-input-error-message {
  margin-top: 4px;
  padding-left: 4px;
  animation: slideDown 200ms ease-out;
}

.tmp-input-error-text {
  color: var(--color-error-primary);
  font-size: var(--font-size-200);
  display: block;
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-5px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===================================
 * COMPACT FILTER VARIANT
 * =================================== */
.tmp-input-filter .tmp-input-container {
  height: 48px;
}

.tmp-input-filter .tmp-input-field {
  padding: 20px 12px 6px 12px;
}

.tmp-input-filter .tmp-input-label {
  left: 12px;
}
