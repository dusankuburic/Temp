<div class="organization-list-header">
  <div class="organization-list-title-section">
    <h1 class="organization-list-title">Organizations</h1>
    <p class="organization-list-subtitle">Manage and view all organizations in the system</p>
  </div>
</div>

<div class="organization-list-container">
  <tmp-card variant="subtle" class="organization-list-filters-card">
    <div class="organization-list-filters-header">
      <h3 class="organization-list-filters-title">Filters</h3>
      <tmp-button variant="success" size="small" (clicked)="openCreateModal()" ariaLabel="Create organization">
        <fa-icon [icon]="plusIcon" [size]="'xl'"></fa-icon>
        <span style="margin-left: var(--spacing-xs);">Create</span>
      </tmp-button>
    </div>
    <form class="organization-list-filters-form" [formGroup]="filtersForm">
      <tmp-select [options]="groupsSelect" [label]="'Groups'" formControlName="withGroups" [isFilter]="true"></tmp-select>
      <tmp-input [placeholder]="'Name'" [label]="'Name'" formControlName="name" [isFilter]="true"></tmp-input>
    </form>
  </tmp-card>

  <tmp-card variant="filled" class="organization-list-table-card">
    <tmp-table
      [columns]="columns"
      [data]="organizations"
      [striped]="true"
      [hoverable]="true"
      [loading]="isLoading"
      emptyMessage="No organizations found">

      <ng-template #rowTemplate let-organization>
        <tr>
          <td>{{ organization.name }}</td>
          <td class="text-center">
            <div class="tmp-button-group">
              <tmp-button variant="primary" size="small" (clicked)="openEditModal(organization.id)" ariaLabel="Edit organization {{organization.name}}">
                <fa-icon [icon]="editOrganizationIcon" [size]="'lg'"></fa-icon>
              </tmp-button>
              <tmp-button variant="danger" size="small" (clicked)="changeStatus(organization.id)" ariaLabel="Archive organization {{organization.name}}">
                <fa-icon [icon]="archiveOrganizationIcon" [size]="'lg'"></fa-icon>
              </tmp-button>
            </div>
          </td>
          <td class="text-center">
            <div class="tmp-button-group">
              <tmp-button
                [variant]="organization.hasActiveGroup ? 'warning' : 'danger'"
                size="small"
                [routerLink]="['/groups/organization/', organization.id]"
                ariaLabel="View groups for {{organization.name}}">
                <fa-icon [icon]="innerGroupsIcon" [size]="'lg'"></fa-icon>
              </tmp-button>
              <tmp-button variant="info" size="small" [routerLink]="['/groups/create/organization/', organization.id]" ariaLabel="Create group for {{organization.name}}">
                <fa-icon [icon]="plusIcon" [size]="'lg'"></fa-icon>
              </tmp-button>
            </div>
          </td>
        </tr>
      </ng-template>
    </tmp-table>
  </tmp-card>

  <div class="organization-list-pagination">
    <tmp-pagination
      [totalCount]="pagination.totalItems"
      [pageSize]="pagination.itemsPerPage"
      [pageNumber]="pagination.currentPage"
      (pageChanged)="pageChanged($event)">
    </tmp-pagination>
  </div>
</div>
